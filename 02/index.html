<html>

<head>
  <title>CS460.org Assignment 2</title>
  <style>
    body {
      background-color: #000;
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden !important;
    }
  </style>
  <script type="text/javascript" src="https://get.goXTK.com/xtk_edge.js"></script>
  <script type="text/javascript" src="./loader.js"></script>
  <script type="text/javascript">
    const CUBE_SIDELENGTH = 10;
    const GAP = 3;
    const CAMERA_CYCLE_DELAY_SECONDS = 2;
    let CAMERAS = [];
    let rotationEnabled = true;
    let enableCameraCycle = true;
    let currentCameraIndex = 0;
    window.onload = () => {
      r = new X.renderer3D();
      r.init();

      const cube = new X.cube();
      cube.lengthX = cube.lengthY = cube.lengthZ = CUBE_SIDELENGTH;

      r.add(cube);

      r.render();

      r.onRender = () => {
        if (rotationEnabled) {
          r.camera.rotate([1, 0]);
        }
      }

      setInterval(() => {
        if (enableCameraCycle && CAMERAS.length > 0) {
          currentCameraIndex = (currentCameraIndex + 1) % CAMERAS.length;
          r.camera.view = new Float32Array(CAMERAS[currentCameraIndex]);
          console.log(r.camera.view)
          console.log(currentCameraIndex)
        }
      }, CAMERA_CYCLE_DELAY_SECONDS * 1000);

      window.onkeypress = (e) => {
        switch (e.code) {
          case 'KeyD':
            cube.transform.translateX(-CUBE_SIDELENGTH - GAP);
            break;
          case 'KeyA':
            cube.transform.translateX(CUBE_SIDELENGTH + GAP);
            break;
          case 'KeyS':
            cube.transform.translateZ(-CUBE_SIDELENGTH - GAP);
            break;
          case 'KeyW':
            cube.transform.translateZ(CUBE_SIDELENGTH + GAP);
            break;
          case 'KeyE':
            cube.transform.translateY(-CUBE_SIDELENGTH - GAP);
            break;
          case 'KeyQ':
            cube.transform.translateY(CUBE_SIDELENGTH + GAP);
            break;
          case 'Digit1': // white
            cube.color = [1, 1, 1];
            break;
          case 'Digit2': // red
            cube.color = [1, 0, 0];
            break;
          case 'Digit3': // green
            cube.color = [0, 1, 0];
            break;
          case 'Digit4': // blue
            cube.color = [0, 0, 1];
            break;
          case 'Digit5': // green
            cube.color = [1, 1, 0];
            break;
          case 'Digit6': // pink
            cube.color = [1, .2, .5];
            break;
          case 'Digit7': // cyan
            cube.color = [0, 1, 1];
            break;
          case 'Digit0': // black
            cube.color = [0, 0, 0];
            break;
          case 'Space':
            newCube = new X.cube();
            newCube.color = cube.color;
            newCube.transform.matrix = new Float32Array(cube.transform.matrix);
            newCube.lengthX = newCube.lengthY = newCube.lengthZ = CUBE_SIDELENGTH;
            r.add(newCube);
            break;
          case 'KeyO':
            download();
            break;
          case 'KeyL':
            upload("scene.json");
            break;
          case 'KeyB':
            rotationEnabled = !rotationEnabled;
            break;
          case 'KeyC':
            CAMERAS.push(new Float32Array(r.camera.view));
            break;
          case 'KeyV':
            enableCameraCycle = !enableCameraCycle;
          default:
            break;
        }
      };
    }
  </script>
</head>

<body>
</body>

</html>
